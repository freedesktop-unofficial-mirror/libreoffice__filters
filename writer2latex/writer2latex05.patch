--- misc/build/writer2latex05/build.xml-old	2008-06-12 00:53:19.000000000 +0200
+++ misc/build/writer2latex05/build.xml	2008-06-12 00:53:38.000000000 +0200
@@ -7,9 +7,6 @@
 -->
 <project name="w2l" default="help" basedir=".">
 
-    <!-- set this property to the location of your SO/OOo installation -->
-	<property name="OFFICE_HOME" location="c:/programmer/sun/staroffice 8"/>
-
     <description>writer2latex - build file</description>
 
     <target name="help" description="Displays usage information">
@@ -40,7 +37,7 @@
     <property name="target.lib" location="target/lib"/>
     <!-- classpath for the application; needs java-uno classes -->
     <path id="main.class.path"> 
-        <filelist dir="${OFFICE_HOME}/program/classes"
+        <filelist dir="${solar.jar}"
             files="jurt.jar,unoil.jar,ridl.jar,juh.jar"/>
     </path> 
 
@@ -85,7 +85,7 @@
                 <attribute name="Main-Class" value="writer2latex.Application"/>
                 <!-- OOo needs this to register the filter: -->
                 <attribute name="RegistrationClassName" value="writer2latex.filter.W2LExportFilter" />
-                <attribute name="Class-Path" value="jaxp.jar parser.jar"/>
+                <attribute name="Class-Path" value="jaxp.jar jaxp_parser_impl.jar"/>
             </manifest>
         </jar>
     </target>
--- misc/build/writer2latex05/source/writer2latex/office/ImageLoader.java       2007-04-17 09:30:42.000000000 +0200
+++ misc/build/writer2latex05/source/writer2latex/office/ImageLoader.java        2007-11-20 21:18:32.000000000 +0100
@@ -107,8 +107,8 @@
                 }
                 // TODO: Use another base64 decoder. This one is "nonstandard"
                 try {
-                    blob = new sun.misc.BASE64Decoder().decodeBuffer(buf.toString());
-                } catch (IOException e) {
+                   blob = org.apache.xerces.impl.dv.util.Base64.decode(buf.toString());
+                } catch (Exception e) {
                     System.err.println("Oops - error converting base64");
                 }
                 sMIME = MIMETypes.getMagicMIMEType(blob);
